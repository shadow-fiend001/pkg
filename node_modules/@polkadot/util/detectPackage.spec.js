"use strict";

var _ = require(".");

// Copyright 2017-2020 @polkadot/util authors & contributors
// This software may be modified and distributed under the terms
// of the Apache-2.0 license. See the LICENSE file for details.
describe('assertSingletonPackage', () => {
  const PKG = '@polkadot/util';
  const VER1 = '9.8.0-beta.45';
  const VER2 = '9.7.1';
  const PATH = '/Users/jaco/Projects/polkadot-js/api/node_modules/@polkadot/util';
  it('should not log the first time', () => {
    const spy = jest.spyOn(console, 'warn');
    (0, _.detectPackage)({
      name: PKG,
      version: VER1
    }, "".concat(PATH, "/01"));
    expect(spy).not.toHaveBeenCalled();
    spy.mockRestore();
  });
  it('should log the second time', () => {
    const spy = jest.spyOn(console, 'warn');
    (0, _.detectPackage)({
      name: PKG,
      version: VER2
    }, "".concat(PATH, "/02"));
    expect(spy).toHaveBeenCalledWith("Multiple instances of @polkadot/util detected, ensure that there is only one package in your dependency tree.\n\t".concat(VER1, "\t").concat(PATH, "/01\n\t").concat(VER2, "        \t").concat(PATH, "/02"));
    spy.mockRestore();
  });
});